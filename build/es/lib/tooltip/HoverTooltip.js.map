{"version":3,"sources":["../../../../src/lib/tooltip/HoverTooltip.js"],"names":["React","Component","PropTypes","GenericComponent","sum","first","last","isNotDefined","isDefined","hexToRGBA","settings","HoverTooltip","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","pointer","helper","height","context","bgFill","bgOpacity","backgroundShapeSVG","tooltipSVG","bgheight","bgwidth","x","y","content","centerX","pointWidth","bgSize","bgShape","width","propTypes","chartId","oneOfType","number","string","yAccessor","func","isRequired","tooltipContent","origin","array","fontFamily","fontSize","contextTypes","margin","object","ratio","defaultProps","tooltipCanvas","fill","stroke","fontFill","opacity","backgroundShapeCanvas","fontSizeSmall","PADDING","X","Y","tspans","startY","i","length","textY","push","label","value","fillStyle","strokeStyle","beginPath","rect","font","textAlign","fillText","measureText","originX","left","originY","top","save","setTransform","scale","translate","restore","calculateTooltipSize","canvas","document","createElement","getContext","str","map","reduce","res","size","sumSizes","String","sizes","Math","max","d","normalizeX","normalizeY","mouseXY","xAccessor","currentItem","xScale","chartConfig","xValue","round","findIndex","yValue","chartIndex","id","yScale","show","plotData","displayXAccessor","abs"],"mappings":"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","file":"HoverTooltip.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent from \"../GenericComponent\";\nimport { sum } from \"d3-array\";\n\nimport { first, last, isNotDefined, isDefined, hexToRGBA } from \"../utils\";\nimport settings from \"../../settings\";\n\nclass HoverTooltip extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst pointer = helper(this.props, moreProps, ctx);\n\t\tconst { height } = moreProps;\n\n\t\tif (isNotDefined(pointer)) return null;\n\t\tdrawOnCanvas(ctx, this.props, this.context, pointer, height, moreProps);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tdrawOn={[\"mousemove\", \"pan\"/* , \"mouseleave\" */]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst pointer = helper(this.props, moreProps);\n\n\t\tif (isNotDefined(pointer)) return null;\n\n\t\tconst { bgFill, bgOpacity, backgroundShapeSVG, tooltipSVG } = this.props;\n\t\tconst { bgheight, bgwidth } = this.props;\n\t\tconst { height } = moreProps;\n\n\t\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\n\n\t\tconst bgShape = isDefined(bgwidth) && isDefined(bgheight)\n\t\t\t? { width: bgwidth, height: bgheight }\n\t\t\t: bgSize;\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t<rect x={centerX - pointWidth / 2}\n\t\t\t\t\ty={0}\n\t\t\t\t\twidth={pointWidth}\n\t\t\t\t\theight={height}\n\t\t\t\t\tfill={bgFill}\n\t\t\t\t\topacity={bgOpacity} />\n\t\t\t\t<g className=\"react-stockcharts-tooltip-content\" transform={`translate(${x}, ${y})`}>\n\t\t\t\t\t{backgroundShapeSVG(this.props, bgShape)}\n\t\t\t\t\t{tooltipSVG(this.props, content)}\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t);\n\t}\n}\n\nHoverTooltip.propTypes = {\n\tchartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\tyAccessor: PropTypes.func,\n\ttooltipSVG: PropTypes.func,\n\tbackgroundShapeSVG: PropTypes.func,\n\tbgwidth: PropTypes.number,\n\tbgheight: PropTypes.number,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\ttooltipContent: PropTypes.func.isRequired,\n\torigin: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.func\n\t]).isRequired,\n\tfontFamily: PropTypes.string,\n\tfontSize: PropTypes.number,\n};\n\nHoverTooltip.contextTypes = {\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n};\n\nHoverTooltip.defaultProps = {\n\t// bgwidth: 150,\n\t// bgheight: 50,\n\ttooltipSVG: tooltipSVG,\n\ttooltipCanvas: tooltipCanvas,\n\torigin: origin,\n\tfill: \"#D4E2FD\",\n\tbgFill: \"#D4E2FD\",\n\tbgOpacity: 0.5,\n\tstroke: \"#9B9BFF\",\n\tfontFill: \"#000000\",\n\topacity: 0.8,\n\tbackgroundShapeSVG: backgroundShapeSVG,\n\tbackgroundShapeCanvas: backgroundShapeCanvas,\n\tfontFamily: settings.fontFamily,\n\tfontSize: settings.fontSizeSmall,\n};\n\nconst PADDING = 5;\nconst X = 10;\nconst Y = 10;\n\n\n/* eslint-disable react/prop-types */\nfunction backgroundShapeSVG({ fill, stroke, opacity }, { height, width }) {\n\treturn <rect\n\t\theight={height}\n\t\twidth={width}\n\t\tfill={fill}\n\t\topacity={opacity}\n\t\tstroke={stroke} />;\n}\n\nfunction tooltipSVG({ fontFamily, fontSize, fontFill }, content) {\n\tconst tspans = [];\n\tconst startY = Y + fontSize * 0.9;\n\n\tfor (let i = 0; i < content.y.length; i++) {\n\t\tconst y = content.y[i];\n\t\tconst textY = startY + (fontSize * (i + 1));\n\n\t\ttspans.push(<tspan key={`L-${i}`} x={X} y={textY} fill={y.stroke}>{y.label}</tspan>);\n\t\ttspans.push(<tspan key={i}>: </tspan>);\n\t\ttspans.push(<tspan key={`V-${i}`}>{y.value}</tspan>);\n\t}\n\treturn <text fontFamily={fontFamily} fontSize={fontSize} fill={fontFill}>\n\t\t<tspan x={X} y={startY}>{content.x}</tspan>\n\t\t{tspans}\n\t</text>;\n}\n/* eslint-enable react/prop-types */\n\nfunction backgroundShapeCanvas(props, { width, height }, ctx) {\n\tconst { fill, stroke, opacity } = props;\n\n\tctx.fillStyle = hexToRGBA(fill, opacity);\n\tctx.strokeStyle = stroke;\n\tctx.beginPath();\n\tctx.rect(0, 0, width, height);\n\tctx.fill();\n\tctx.stroke();\n}\n\nfunction tooltipCanvas({ fontFamily, fontSize, fontFill }, content, ctx) {\n\tconst startY = Y + fontSize * 0.9;\n\tctx.font = `${fontSize}px ${fontFamily}`;\n\tctx.fillStyle = fontFill;\n\tctx.textAlign = \"left\";\n\tctx.fillText(content.x, X, startY);\n\n\tfor (let i = 0; i < content.y.length; i++) {\n\t\tconst y = content.y[i];\n\t\tconst textY = startY + (fontSize * (i + 1));\n\t\tctx.fillStyle = y.stroke || fontFill;\n\t\tctx.fillText(y.label, X, textY);\n\n\t\tctx.fillStyle = fontFill;\n\t\tctx.fillText(\": \" + y.value, X + ctx.measureText(y.label).width, textY);\n\t}\n}\n\nfunction drawOnCanvas(ctx, props, context, pointer, height) {\n\n\tconst { margin, ratio } = context;\n\tconst { bgFill, bgOpacity } = props;\n\tconst { backgroundShapeCanvas, tooltipCanvas } = props;\n\n\tconst originX = 0.5 * ratio + margin.left;\n\tconst originY = 0.5 * ratio + margin.top;\n\n\tctx.save();\n\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.scale(ratio, ratio);\n\n\tctx.translate(originX, originY);\n\n\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\n\n\tctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\n\tctx.beginPath();\n\tctx.rect(centerX - pointWidth / 2, 0, pointWidth, height);\n\tctx.fill();\n\n\tctx.translate(x, y);\n\tbackgroundShapeCanvas(props, bgSize, ctx);\n\ttooltipCanvas(props, content, ctx);\n\n\tctx.restore();\n}\n\nfunction calculateTooltipSize({ fontFamily, fontSize, fontFill }, content, ctx) {\n\tif (isNotDefined(ctx)) {\n\t\tconst canvas = document.createElement(\"canvas\");\n\t\tctx = canvas.getContext(\"2d\");\n\t}\n\n\tctx.font = `${fontSize}px ${fontFamily}`;\n\tctx.fillStyle = fontFill;\n\tctx.textAlign = \"left\";\n\n\tconst measureText = str => ({\n\t\twidth: ctx.measureText(str).width,\n\t\theight: fontSize,\n\t});\n\n\tconst { width, height } = content.y\n\t\t.map(({ label, value }) => measureText(`${label}: ${value}`))\n\t\t// Sum all y and x sizes (begin with x label size)\n\t\t.reduce((res, size) => sumSizes(res, size), measureText(String(content.x)))\n\t;\n\n\treturn {\n\t\twidth: width + 2 * X,\n\t\theight: height + 2 * Y\n\t};\n}\n\nfunction sumSizes(...sizes) {\n\treturn {\n\t\twidth: Math.max(...sizes.map(size => size.width)),\n\t\theight: sum(sizes, d => d.height),\n\t};\n}\n\nfunction normalizeX(x, bgSize, pointWidth, width) {\n\t// return x - bgSize.width - pointWidth / 2 - PADDING * 2 < 0\n\treturn x < width / 2\n\t\t? x + pointWidth / 2 + PADDING\n\t\t: x - bgSize.width - pointWidth / 2 - PADDING;\n}\n\nfunction normalizeY(y, bgSize) {\n\treturn y - bgSize.height <= 0\n\t\t? y + PADDING\n\t\t: y - bgSize.height - PADDING;\n}\n\nfunction origin(props, moreProps, bgSize, pointWidth) {\n\tconst { chartId, yAccessor } = props;\n\tconst { mouseXY, xAccessor, currentItem, xScale, chartConfig, width } = moreProps;\n\tlet y = last(mouseXY);\n\n\tconst xValue = xAccessor(currentItem);\n\tlet x = Math.round(xScale(xValue));\n\n\tif (isDefined(chartId) && isDefined(yAccessor)\n\t\t\t&& isDefined(chartConfig) && isDefined(chartConfig.findIndex)) {\n\t\tconst yValue = yAccessor(currentItem);\n\t\tconst chartIndex = chartConfig.findIndex(x => x.id === chartId);\n\n\t\ty = Math.round(chartConfig[chartIndex].yScale(yValue));\n\t}\n\n\tx = normalizeX(x, bgSize, pointWidth, width);\n\ty = normalizeY(y, bgSize);\n\n\treturn [x, y];\n}\n\nfunction helper(props, moreProps, ctx) {\n\tconst { show, xScale, currentItem, plotData } = moreProps;\n\tconst { origin, tooltipContent } = props;\n\tconst { xAccessor, displayXAccessor } = moreProps;\n\n\tif (!show || isNotDefined(currentItem)) return;\n\n\tconst xValue = xAccessor(currentItem);\n\n\tif (!show || isNotDefined(xValue)) return;\n\n\tconst content = tooltipContent({ currentItem, xAccessor: displayXAccessor });\n\tconst centerX = xScale(xValue);\n\tconst pointWidth = Math.abs(xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)))) / (plotData.length - 1);\n\n\tconst bgSize = calculateTooltipSize(props, content, ctx);\n\n\tconst [x, y] = origin(props, moreProps, bgSize, pointWidth);\n\n\treturn { x, y, content, centerX, pointWidth, bgSize };\n}\n\nexport default HoverTooltip;\n"]}