{"version":3,"sources":["../../../../src/lib/coordinates/MouseCoordinateXV2.js"],"names":["React","Component","PropTypes","GenericChartComponent","getMouseCanvas","settings","propTypes","xPosition","func","drawCoordinate","displayFormat","isRequired","at","oneOf","orient","text","shape","fontStyle","string","fontWeight","fontFamily","fontSize","number","fill","oneOfType","bg","stroke","strokeWidth","padding","left","right","top","bottom","dx","dy","defaultProps","fontSizeBig","MouseCoordinateXV2","props","drawOnCanvas","bind","ctx","moreProps","show","currentItem","getXCoordinateInfo","xAccessor","xValue","xScale","height","chartConfig","font","t","textWidth","measureText","width","y","x","Math","round","textFill","textAlign","sign","halfWidth","strokeStyle","fillStyle","lineWidth","beginPath","moveTo","lineTo","closePath","textBaseline","pad","fillText"],"mappings":";;;;;;;;AAEA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;;AAEA,OAAOC,qBAAP,MAAkC,0BAAlC;AACA,SAASC,cAAT,QAA+B,qBAA/B;AACA,OAAOC,QAAP,MAAqB,gBAArB;;AAGA,IAAMC,YAAY;AACjBC,YAAWL,UAAUM,IADJ;AAEjBC,iBAAgBP,UAAUM,IAFT;AAGjBE,gBAAeR,UAAUM,IAAV,CAAeG,UAHb;AAIjBC,KAAIV,UAAUW,KAAV,CAAgB,CAAC,QAAD,EAAW,KAAX,CAAhB,CAJa;AAKjBC,SAAQZ,UAAUW,KAAV,CAAgB,CAAC,QAAD,EAAW,KAAX,CAAhB,CALS;AAMjBE,OAAMb,UAAUc,KAAV,CAAgB;AACrBC,aAAWf,UAAUgB,MADA;AAErBC,cAAYjB,UAAUgB,MAFD;AAGrBE,cAAYlB,UAAUgB,MAHD;AAIrBG,YAAUnB,UAAUoB,MAJC;AAKrBC,QAAMrB,UAAUsB,SAAV,CAAoB,CAACtB,UAAUM,IAAX,EAAiBN,UAAUgB,MAA3B,CAApB;AALe,EAAhB,CANW;AAajBO,KAAIvB,UAAUc,KAAV,CAAgB;AACnBO,QAAMrB,UAAUsB,SAAV,CAAoB,CAACtB,UAAUM,IAAX,EAAiBN,UAAUgB,MAA3B,CAApB,CADa;AAEnBQ,UAAQxB,UAAUgB,MAFC;AAGnBS,eAAazB,UAAUoB,MAHJ;AAInBM,WAAS1B,UAAUc,KAAV,CAAgB;AACxBa,SAAM3B,UAAUoB,MADQ;AAExBQ,UAAO5B,UAAUoB,MAFO;AAGxBS,QAAK7B,UAAUoB,MAHS;AAIxBU,WAAQ9B,UAAUoB;AAJM,GAAhB;AAJU,EAAhB,CAba;AAwBjBW,KAAI/B,UAAUoB,MAxBG;AAyBjBY,KAAIhC,UAAUoB;AAzBG,CAAlB;;AA4BA,IAAMa,eAAe;AACpB5B,qBADoB;AAEpBE,+BAFoB;AAGpBG,KAAI,QAHgB;AAIpBE,SAAQ,QAJY;;AAMpBC,OAAM;AACLE,aAAW,EADN;AAELE,cAAY,EAFP;AAGLC,cAAYf,SAASe,UAHhB;AAILC,YAAUhB,SAAS+B,WAJd;AAKLb,QAAM;AALD,EANc;AAapBE,KAAI;AACHF,QAAM,oBADH;AAEHG,UAAQ,iBAFL;AAGHC,eAAa,CAHV;AAIHC,WAAS;AACRC,SAAM,CADE;AAERC,UAAO,CAFC;AAGRC,QAAK,CAHG;AAIRC,WAAQ;AAJA;AAJN,EAbgB;AAwBpBC,KAAI,CAxBgB;AAyBpBC,KAAI;AAzBgB,CAArB;;IA4BMG,kB;;;AACL,6BAAYC,KAAZ,EAAmB;AAAA;;AAAA,sIACZA,KADY;;AAElB,QAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,OAApB;AAFkB;AAGlB;;;;+BACYC,G,EAAKC,S,EAAW;AAAA,OACpBC,IADoB,GACED,SADF,CACpBC,IADoB;AAAA,OACdC,WADc,GACEF,SADF,CACdE,WADc;AAAA,OAEpBnC,cAFoB,GAED,KAAK6B,KAFJ,CAEpB7B,cAFoB;;;AAI5B,OAAIkC,QAAQC,eAAe,IAA3B,EAAiC;AAChC,QAAM5B,QAAQ6B,mBAAmBJ,GAAnB,EAAwB,KAAKH,KAA7B,EAAoCI,SAApC,CAAd;AACAjC,mBAAegC,GAAf,EAAoBzB,KAApB,EAA2B,KAAKsB,KAAhC,EAAuCI,SAAvC;AACA;AACD;;;2BACQ;AACR,UACC,oBAAC,qBAAD;AACC,UAAM,KADP;AAEC,gBAAY,KAAKH,YAFlB;AAGC,kBAAcnC,cAHf;AAIC,YAAQ,CAAC,WAAD,EAAc,KAAd,EAAqB,MAArB;AAJT,KADD;AAQA;;;;EAvB+BH,S;;AA0BjCoC,mBAAmBF,YAAnB,GAAkCA,YAAlC;AACAE,mBAAmB/B,SAAnB,GAA+BA,SAA/B;;AAGA,SAASC,SAAT,CAAmB+B,KAAnB,EAA0BI,SAA1B,EAAqC;AAAA,KAC5BE,WAD4B,GACDF,SADC,CAC5BE,WAD4B;AAAA,KACfE,SADe,GACDJ,SADC,CACfI,SADe;;AAEpC,QAAOA,UAAUF,WAAV,CAAP;AACA;AACD,SAASC,kBAAT,CAA4BJ,GAA5B,EAAiCH,KAAjC,EAAwCI,SAAxC,EAAmD;AAAA,KAC1CnC,SAD0C,GAC5B+B,KAD4B,CAC1C/B,SAD0C;;AAElD,KAAMwC,SAASxC,UAAU+B,KAAV,EAAiBI,SAAjB,CAAf;AAFkD,KAG1C9B,EAH0C,GAGpB0B,KAHoB,CAG1C1B,EAH0C;AAAA,KAGtCF,aAHsC,GAGpB4B,KAHoB,CAGtC5B,aAHsC;AAAA,KAI1CK,IAJ0C,GAIjCuB,KAJiC,CAI1CvB,IAJ0C;AAAA,KAK1CiC,MAL0C,GAKNN,SALM,CAK1CM,MAL0C;AAAA,KAKnBC,MALmB,GAKNP,SALM,CAKlCQ,WALkC,CAKnBD,MALmB;;AAMlDR,KAAIU,IAAJ,GAAcpC,KAAKE,SAAnB,SAAgCF,KAAKI,UAArC,SAAmDJ,KAAKM,QAAxD,WAAsEN,KAAKK,UAA3E;;AAEA,KAAMgC,IAAI1C,cAAcqC,MAAd,CAAV;AACA,KAAMM,YAAYZ,IAAIa,WAAJ,CAAgBF,CAAhB,EAAmBG,KAArC;;AAEA,KAAMC,IAAI5C,OAAO,QAAP,GAAkBqC,MAAlB,GAA2B,CAArC;AACA,KAAMQ,IAAIC,KAAKC,KAAL,CAAWX,OAAOD,MAAP,CAAX,CAAV;;AAEA,QAAO;AACNU,MADM;AAEND,MAFM;AAGNH,sBAHM;AAINtC,QAAMqC;AAJA,EAAP;AAMA;;AAED,SAAS3C,cAAT,CACCgC,GADD,EAECzB,KAFD,EAGCsB,KAHD,EAICI,SAJD,EAKE;AAAA,KACOe,CADP,GACiCzC,KADjC,CACOyC,CADP;AAAA,KACUD,CADV,GACiCxC,KADjC,CACUwC,CADV;AAAA,KACaH,SADb,GACiCrC,KADjC,CACaqC,SADb;AAAA,KACwBtC,IADxB,GACiCC,KADjC,CACwBD,IADxB;AAAA,KAEOD,MAFP,GAE0BwB,KAF1B,CAEOxB,MAFP;AAAA,KAEemB,EAFf,GAE0BK,KAF1B,CAEeL,EAFf;AAAA,KAEmBC,EAFnB,GAE0BI,KAF1B,CAEmBJ,EAFnB;AAAA,iBAOGI,KAPH,CAKAb,EALA;AAAA,KAKMG,OALN,aAKMA,OALN;AAAA,KAKeL,IALf,aAKeA,IALf;AAAA,KAKqBG,MALrB,aAKqBA,MALrB;AAAA,KAK6BC,WAL7B,aAK6BA,WAL7B;AAAA,mBAOGW,KAPH,CAMAvB,IANA;AAAA,KAMQM,QANR,eAMQA,QANR;AAAA,KAMwBuC,QANxB,eAMkBrC,IANlB;;;AASDkB,KAAIoB,SAAJ,GAAgB,QAAhB;;AAEA,KAAMC,OAAOhD,WAAW,KAAX,GAAmB,CAAC,CAApB,GAAwB,CAArC;AACA,KAAMiD,YAAYL,KAAKC,KAAL,CAAWN,YAAY,CAAZ,GAAgBzB,QAAQE,KAAnC,CAAlB;AACA,KAAMmB,SAASS,KAAKC,KAAL,CAAWtC,WAAWO,QAAQG,GAAnB,GAAyBH,QAAQI,MAA5C,CAAf;;AAEAS,KAAIuB,WAAJ,GAAkB,OAAOtC,MAAP,KAAkB,UAAlB,GAA+BA,OAAOgB,SAAP,EAAkBD,GAAlB,CAA/B,GAAwDf,MAA1E;AACAe,KAAIwB,SAAJ,GAAgB,OAAO1C,IAAP,KAAgB,UAAhB,GAA6BA,KAAKmB,SAAL,EAAgBD,GAAhB,CAA7B,GAAoDlB,IAApE;AACAkB,KAAIyB,SAAJ,GAAgB,OAAOvC,WAAP,KAAuB,UAAvB,GAAoCA,YAAYe,SAAZ,CAApC,GAA6Df,WAA7E;;AAEAc,KAAI0B,SAAJ;;AAEA1B,KAAI2B,MAAJ,CAAWX,CAAX,EAAcD,CAAd;AACAf,KAAI4B,MAAJ,CAAWZ,IAAIxB,EAAf,EAAmBuB,IAAIM,OAAO5B,EAA9B;AACAO,KAAI4B,MAAJ,CAAWZ,IAAIM,SAAf,EAA0BP,IAAIM,OAAO5B,EAArC;AACAO,KAAI4B,MAAJ,CAAWZ,IAAIM,SAAf,EAA0BP,IAAIM,QAAQ5B,KAAKe,MAAb,CAA9B;AACAR,KAAI4B,MAAJ,CAAWZ,IAAIM,SAAf,EAA0BP,IAAIM,QAAQ5B,KAAKe,MAAb,CAA9B;AACAR,KAAI4B,MAAJ,CAAWZ,IAAIM,SAAf,EAA0BP,IAAIM,OAAO5B,EAArC;AACAO,KAAI4B,MAAJ,CAAWZ,IAAIxB,EAAf,EAAmBuB,IAAIM,OAAO5B,EAA9B;AACAO,KAAI6B,SAAJ;AACA7B,KAAIf,MAAJ;AACAe,KAAIlB,IAAJ;;AAEAkB,KAAI0B,SAAJ;AACA1B,KAAIwB,SAAJ,GAAgB,OAAOL,QAAP,KAAoB,UAApB,GAAiCA,SAASlB,SAAT,EAAoBD,GAApB,CAAjC,GAA4DmB,QAA5E;;AAEAnB,KAAI8B,YAAJ,GAAmBzD,WAAW,KAAX,GAAmB,YAAnB,GAAkC,SAArD;AACA,KAAM0D,MAAM1D,WAAW,KAAX,GAAmBc,QAAQI,MAA3B,GAAoCJ,QAAQG,GAAxD;;AAEAU,KAAIgC,QAAJ,CAAa1D,IAAb,EAAmB0C,CAAnB,EAAsBD,IAAIM,QAAQ5B,KAAKsC,GAAL,GAAW,CAAnB,CAA1B;AACA;;AAED,eAAenC,kBAAf","file":"MouseCoordinateXV2.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getMouseCanvas } from \"../GenericComponent\";\nimport settings from \"../../settings\";\n\n\nconst propTypes = {\n\txPosition: PropTypes.func,\n\tdrawCoordinate: PropTypes.func,\n\tdisplayFormat: PropTypes.func.isRequired,\n\tat: PropTypes.oneOf([\"bottom\", \"top\"]),\n\torient: PropTypes.oneOf([\"bottom\", \"top\"]),\n\ttext: PropTypes.shape({\n\t\tfontStyle: PropTypes.string,\n\t\tfontWeight: PropTypes.string,\n\t\tfontFamily: PropTypes.string,\n\t\tfontSize: PropTypes.number,\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n\t}),\n\tbg: PropTypes.shape({\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n\t\tstroke: PropTypes.string,\n\t\tstrokeWidth: PropTypes.number,\n\t\tpadding: PropTypes.shape({\n\t\t\tleft: PropTypes.number,\n\t\t\tright: PropTypes.number,\n\t\t\ttop: PropTypes.number,\n\t\t\tbottom: PropTypes.number\n\t\t}),\n\t}),\n\tdx: PropTypes.number,\n\tdy: PropTypes.number\n};\n\nconst defaultProps = {\n\txPosition,\n\tdrawCoordinate,\n\tat: \"bottom\",\n\torient: \"bottom\",\n\n\ttext: {\n\t\tfontStyle: \"\",\n\t\tfontWeight: \"\",\n\t\tfontFamily: settings.fontFamily,\n\t\tfontSize: settings.fontSizeBig,\n\t\tfill: \"rgb(35, 35, 35)\"\n\t},\n\tbg: {\n\t\tfill: \"rgb(255, 255, 255)\",\n\t\tstroke: \"rgb(35, 35, 35)\",\n\t\tstrokeWidth: 1,\n\t\tpadding: {\n\t\t\tleft: 7,\n\t\t\tright: 7,\n\t\t\ttop: 4,\n\t\t\tbottom: 4\n\t\t}\n\t},\n\tdx: 7,\n\tdy: 7\n};\n\nclass MouseCoordinateXV2 extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { show, currentItem } = moreProps;\n\t\tconst { drawCoordinate } = this.props;\n\n\t\tif (show && currentItem != null) {\n\t\t\tconst shape = getXCoordinateInfo(ctx, this.props, moreProps);\n\t\t\tdrawCoordinate(ctx, shape, this.props, moreProps);\n\t\t}\n\t}\n\trender() {\n\t\treturn (\n\t\t\t<GenericChartComponent\n\t\t\t\tclip={false}\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\nMouseCoordinateXV2.defaultProps = defaultProps;\nMouseCoordinateXV2.propTypes = propTypes;\n\n\nfunction xPosition(props, moreProps) {\n\tconst { currentItem, xAccessor } = moreProps;\n\treturn xAccessor(currentItem);\n}\nfunction getXCoordinateInfo(ctx, props, moreProps) {\n\tconst { xPosition } = props;\n\tconst xValue = xPosition(props, moreProps);\n\tconst { at, displayFormat } = props;\n\tconst { text } = props;\n\tconst { xScale, chartConfig: { height } } = moreProps;\n\tctx.font = `${text.fontStyle} ${text.fontWeight} ${text.fontSize}px ${text.fontFamily}`;\n\n\tconst t = displayFormat(xValue);\n\tconst textWidth = ctx.measureText(t).width;\n\n\tconst y = at === \"bottom\" ? height : 0;\n\tconst x = Math.round(xScale(xValue));\n\n\treturn {\n\t\tx,\n\t\ty,\n\t\ttextWidth,\n\t\ttext: t\n\t};\n}\n\nfunction drawCoordinate(\n\tctx,\n\tshape,\n\tprops,\n\tmoreProps\n) {\n\tconst { x, y, textWidth, text } = shape;\n\tconst { orient, dx, dy } = props;\n\n\tconst {\n\t\tbg: { padding, fill, stroke, strokeWidth },\n\t\ttext: { fontSize, fill: textFill }\n\t} = props;\n\n\tctx.textAlign = \"center\";\n\n\tconst sign = orient === \"top\" ? -1 : 1;\n\tconst halfWidth = Math.round(textWidth / 2 + padding.right);\n\tconst height = Math.round(fontSize + padding.top + padding.bottom);\n\n\tctx.strokeStyle = typeof stroke === \"function\" ? stroke(moreProps, ctx) : stroke;\n\tctx.fillStyle = typeof fill === \"function\" ? fill(moreProps, ctx) : fill;\n\tctx.lineWidth = typeof strokeWidth === \"function\" ? strokeWidth(moreProps) : strokeWidth;\n\n\tctx.beginPath();\n\n\tctx.moveTo(x, y);\n\tctx.lineTo(x + dx, y + sign * dy);\n\tctx.lineTo(x + halfWidth, y + sign * dy);\n\tctx.lineTo(x + halfWidth, y + sign * (dy + height));\n\tctx.lineTo(x - halfWidth, y + sign * (dy + height));\n\tctx.lineTo(x - halfWidth, y + sign * dy);\n\tctx.lineTo(x - dx, y + sign * dy);\n\tctx.closePath();\n\tctx.stroke();\n\tctx.fill();\n\n\tctx.beginPath();\n\tctx.fillStyle = typeof textFill === \"function\" ? textFill(moreProps, ctx) : textFill;\n\n\tctx.textBaseline = orient === \"top\" ? \"alphabetic\" : \"hanging\";\n\tconst pad = orient === \"top\" ? padding.bottom : padding.top;\n\n\tctx.fillText(text, x, y + sign * (dy + pad + 2));\n}\n\nexport default MouseCoordinateXV2;"]}