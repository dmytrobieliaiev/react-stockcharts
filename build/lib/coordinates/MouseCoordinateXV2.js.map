{"version":3,"sources":["../../../src/lib/coordinates/MouseCoordinateXV2.js"],"names":["propTypes","xPosition","PropTypes","func","drawCoordinate","displayFormat","isRequired","at","oneOf","orient","text","shape","fontStyle","string","fontWeight","fontFamily","fontSize","number","fill","oneOfType","bg","stroke","strokeWidth","padding","left","right","top","bottom","dx","dy","defaultProps","settings","fontSizeBig","MouseCoordinateXV2","props","drawOnCanvas","bind","ctx","moreProps","show","currentItem","getXCoordinateInfo","getMouseCanvas","Component","xAccessor","xValue","xScale","height","chartConfig","font","t","textWidth","measureText","width","y","x","Math","round","textFill","textAlign","sign","halfWidth","strokeStyle","fillStyle","lineWidth","beginPath","moveTo","lineTo","closePath","textBaseline","pad","fillText"],"mappings":"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","file":"MouseCoordinateXV2.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getMouseCanvas } from \"../GenericComponent\";\nimport settings from \"../../settings\";\n\n\nconst propTypes = {\n\txPosition: PropTypes.func,\n\tdrawCoordinate: PropTypes.func,\n\tdisplayFormat: PropTypes.func.isRequired,\n\tat: PropTypes.oneOf([\"bottom\", \"top\"]),\n\torient: PropTypes.oneOf([\"bottom\", \"top\"]),\n\ttext: PropTypes.shape({\n\t\tfontStyle: PropTypes.string,\n\t\tfontWeight: PropTypes.string,\n\t\tfontFamily: PropTypes.string,\n\t\tfontSize: PropTypes.number,\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n\t}),\n\tbg: PropTypes.shape({\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n\t\tstroke: PropTypes.string,\n\t\tstrokeWidth: PropTypes.number,\n\t\tpadding: PropTypes.shape({\n\t\t\tleft: PropTypes.number,\n\t\t\tright: PropTypes.number,\n\t\t\ttop: PropTypes.number,\n\t\t\tbottom: PropTypes.number\n\t\t}),\n\t}),\n\tdx: PropTypes.number,\n\tdy: PropTypes.number\n};\n\nconst defaultProps = {\n\txPosition,\n\tdrawCoordinate,\n\tat: \"bottom\",\n\torient: \"bottom\",\n\n\ttext: {\n\t\tfontStyle: \"\",\n\t\tfontWeight: \"\",\n\t\tfontFamily: settings.fontFamily,\n\t\tfontSize: settings.fontSizeBig,\n\t\tfill: \"rgb(35, 35, 35)\"\n\t},\n\tbg: {\n\t\tfill: \"rgb(255, 255, 255)\",\n\t\tstroke: \"rgb(35, 35, 35)\",\n\t\tstrokeWidth: 1,\n\t\tpadding: {\n\t\t\tleft: 7,\n\t\t\tright: 7,\n\t\t\ttop: 4,\n\t\t\tbottom: 4\n\t\t}\n\t},\n\tdx: 7,\n\tdy: 7\n};\n\nclass MouseCoordinateXV2 extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { show, currentItem } = moreProps;\n\t\tconst { drawCoordinate } = this.props;\n\n\t\tif (show && currentItem != null) {\n\t\t\tconst shape = getXCoordinateInfo(ctx, this.props, moreProps);\n\t\t\tdrawCoordinate(ctx, shape, this.props, moreProps);\n\t\t}\n\t}\n\trender() {\n\t\treturn (\n\t\t\t<GenericChartComponent\n\t\t\t\tclip={false}\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\nMouseCoordinateXV2.defaultProps = defaultProps;\nMouseCoordinateXV2.propTypes = propTypes;\n\n\nfunction xPosition(props, moreProps) {\n\tconst { currentItem, xAccessor } = moreProps;\n\treturn xAccessor(currentItem);\n}\nfunction getXCoordinateInfo(ctx, props, moreProps) {\n\tconst { xPosition } = props;\n\tconst xValue = xPosition(props, moreProps);\n\tconst { at, displayFormat } = props;\n\tconst { text } = props;\n\tconst { xScale, chartConfig: { height } } = moreProps;\n\tctx.font = `${text.fontStyle} ${text.fontWeight} ${text.fontSize}px ${text.fontFamily}`;\n\n\tconst t = displayFormat(xValue);\n\tconst textWidth = ctx.measureText(t).width;\n\n\tconst y = at === \"bottom\" ? height : 0;\n\tconst x = Math.round(xScale(xValue));\n\n\treturn {\n\t\tx,\n\t\ty,\n\t\ttextWidth,\n\t\ttext: t\n\t};\n}\n\nfunction drawCoordinate(\n\tctx,\n\tshape,\n\tprops,\n\tmoreProps\n) {\n\tconst { x, y, textWidth, text } = shape;\n\tconst { orient, dx, dy } = props;\n\n\tconst {\n\t\tbg: { padding, fill, stroke, strokeWidth },\n\t\ttext: { fontSize, fill: textFill }\n\t} = props;\n\n\tctx.textAlign = \"center\";\n\n\tconst sign = orient === \"top\" ? -1 : 1;\n\tconst halfWidth = Math.round(textWidth / 2 + padding.right);\n\tconst height = Math.round(fontSize + padding.top + padding.bottom);\n\n\tctx.strokeStyle = typeof stroke === \"function\" ? stroke(moreProps, ctx) : stroke;\n\tctx.fillStyle = typeof fill === \"function\" ? fill(moreProps, ctx) : fill;\n\tctx.lineWidth = typeof strokeWidth === \"function\" ? strokeWidth(moreProps) : strokeWidth;\n\n\tctx.beginPath();\n\n\tctx.moveTo(x, y);\n\tctx.lineTo(x + dx, y + sign * dy);\n\tctx.lineTo(x + halfWidth, y + sign * dy);\n\tctx.lineTo(x + halfWidth, y + sign * (dy + height));\n\tctx.lineTo(x - halfWidth, y + sign * (dy + height));\n\tctx.lineTo(x - halfWidth, y + sign * dy);\n\tctx.lineTo(x - dx, y + sign * dy);\n\tctx.closePath();\n\tctx.stroke();\n\tctx.fill();\n\n\tctx.beginPath();\n\tctx.fillStyle = typeof textFill === \"function\" ? textFill(moreProps, ctx) : textFill;\n\n\tctx.textBaseline = orient === \"top\" ? \"alphabetic\" : \"hanging\";\n\tconst pad = orient === \"top\" ? padding.bottom : padding.top;\n\n\tctx.fillText(text, x, y + sign * (dy + pad + 2));\n}\n\nexport default MouseCoordinateXV2;"]}